<!DOCTYPE html>
<html>
    <head>
        <title>The Generics | Store</title>
        <meta name="description" content="This is the description">
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>
        <header class="main-header">
            <nav class="main-nav nav">
                <ul>
                    <li><a href="index.html">HOME</a></li>
                    <li><a href="store.html">STORE</a></li>
                    <li><a href="about.html">ABOUT</a></li>
                </ul>
            </nav>
            <h1 class="band-name band-name-large">The Generics</h1>
        </header>
        <section class="container content-section">
            <h2 class="section-header">MUSIC</h2>
            <div class="shop-items">
                <div class="shop-item">
                    <span class="shop-item-title">Album 1</span>
                    <img class="shop-item-image" src="Images/Album 1.png">
                    <div class="shop-item-details">
                        <span class="shop-item-price">12.99</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
                <div class="shop-item">
                    <span class="shop-item-title">Album 2</span>
                    <img class="shop-item-image" src="Images/Album 2.png">
                    <div class="shop-item-details">
                        <span class="shop-item-price">14.99</span>
                        <button class="btn btn-primary shop-item-button"type="button">ADD TO CART</button>
                    </div>
                </div>
                <div class="shop-item">
                    <span class="shop-item-title">Album 3</span>
                    <img class="shop-item-image" src="Images/Album 3.png">
                    <div class="shop-item-details">
                        <span class="shop-item-price">9.99</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
                <div class="shop-item">
                    <span class="shop-item-title">Album 4</span>
                    <img class="shop-item-image" src="Images/Album 4.png">
                    <div class="shop-item-details">
                        <span class="shop-item-price">19.99</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
            </div>
        </section>
        <section class="container content-section">
            <h2 class="section-header">MERCH</h2>
            <div class="shop-items">
                <div class="shop-item">
                    <span class="shop-item-title">T-Shirt</span>
                    <img class="shop-item-image" src="Images/T-Shirt.png">
                    <div class="shop-item-details">
                        <span class="shop-item-price">19.99</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
                <div class="shop-item">
                    <span class="shop-item-title">Coffee Cup</span>
                    <img class="shop-item-image" src="Images/Coffee Cup.png">
                    <div class="shop-item-details">
                        <span class="shop-item-price">6.99</span>
                        <button class="btn btn-primary shop-item-button" type="button">ADD TO CART</button>
                    </div>
                </div>
            </div>
        </section>
        <section class="container content-section">
            <h2 class="section-header">CART</h2>
            <div class="cart-row">
                <span class="cart-item cart-header cart-column">ITEM</span>
                <span class="cart-price cart-header cart-column">PRICE</span>
                <span class="cart-quantity cart-header cart-column">QUANTITY</span>
            </div>
            <div id="cart-holder" class="cart-items">
                <div id="cart-row" class="cart-row">
                    <div class="cart-item cart-column">
                        <img class="cart-item-image" src="" width="100" height="100">
                        <span class="cart-item-title"></span>
                    </div>
                    <span class="cart-price cart-column"></span>
                    <div class="cart-quantity cart-column">
                        <input name="AMOUNT" class="cart-quantity-input" type="number" value="1" haha="5">
                        <button class="btn btn-danger" type="button">REMOVE</button>
                    </div>
                </div>
            </div>
            <div class="cart-total">
                <strong class="cart-total-title">Total</strong>
                <span id="total" class="cart-total-price">$39.97</span>
            </div>
            <button id="purchase" class="btn btn-primary btn-purchase" type="button">PURCHASE</button>
        </section>
        <footer class="main-footer">
            <div class="container main-footer-container">
                <h3 class="band-name">The Generics</h3>
                <ul class="nav footer-nav">
                    <li>
                        <a href="https://www.youtube.com" target="_blank">
                            <img src="Images/YouTube Logo.png">
                        </a>
                    </li>
                    <li>
                        <a href="https://www.spotify.com" target="_blank">
                            <img src="Images/Spotify Logo.png">
                        </a>
                    </li>
                    <li>
                        <a href="https://www.facebook.com" target="_blank">
                            <img src="Images/Facebook Logo.png">
                        </a>
                    </li>
                </ul>
            </div>
        </footer>
    </body>

    <script>

        let purchaseButton = document.getElementById("purchase")

        let cartHolder = document.getElementById('cart-holder')
        let shopItemRow = document.getElementById("cart-row")
    
        let actualTotal = 0

        shopItemRow.style.display = "none"

        let total = document.getElementById("total")
        let shopItems = document.getElementsByClassName("shop-item")

        total.innerText = "$0"

        let ItemsInCart = []

        for (let i = 0; i < shopItems.length; i++) {
            let buttons = shopItems[i].children[2].children[1]
            let nameOfItem = buttons.parentNode.parentNode.children[0].innerText
            let priceOfItem = parseFloat(buttons.parentNode.parentNode.children[2].children[0].innerHTML)
            buttons.onclick = function() {

               for (let i = 0; i < ItemsInCart.length; i++) {
                    if (ItemsInCart[i] == nameOfItem) {
                        alert(nameOfItem + " is already in your cart.")
                        return
                    }
               }

               let clonedRow = shopItemRow.cloneNode(true)
               clonedRow.style.display = ''
               cartHolder.append(clonedRow)

               ItemsInCart.push(nameOfItem)

               clonedRow.setAttribute("name", "CLONED")
               clonedRow.name = "CLONED"
               clonedRow.children[1].innerText = priceOfItem
               clonedRow.children[0].children[0].src = `Images/${nameOfItem}.png`
               
               clonedRow.children[0].children[1].innerText = nameOfItem

               actualTotal = actualTotal + priceOfItem
               total.innerText = `$${Math.round((actualTotal + Number.EPSILON) * 100) / 100}`

               // amount changer

               clonedRow.children[2].children[0].addEventListener("change", function() {
                    let inputElement = clonedRow.children[2].children[0]
                    if (inputElement.value <= 1) {
                        inputElement.value = 1
                    }
               })

               clonedRow.children[2].children[1].onclick = function() {
                    for (let i = 0; i < ItemsInCart.length; i++) {
                        if (ItemsInCart[i] == nameOfItem) {
                            ItemsInCart.splice(i,1)
                        }
                    }
                    clonedRow.remove()
                    actualTotal = actualTotal - priceOfItem    
                    total.innerText = `$${Math.round((actualTotal + Number.EPSILON) * 100) / 100}` 
                    console.log(actualTotal)
                    console.log(ItemsInCart)
               }
               
            } 
        }  

        purchaseButton.onclick = function()  {
            let cartHolderChildren = document.getElementsByName("CLONED")
            ItemsInCart = []
            while (cartHolderChildren.length > 0) {
               for (let i = 0; i < cartHolderChildren.length; i++) {
                cartHolderChildren[i].remove()
                } 
            }
            actualTotal = 0
            total.innerText = "$0"
        }

    </script>
</html>